---
title: "GEE Comparison"
author: "Jon Ong"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
rm(list=ls()); gc()
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(data.table, dplyr, gee, geepack)
load("Output/batch0316.rda")
```

## Objectives

### 1 - Compare if different GEE packages (GEE and GEEPACK) produce the same output.

Short answer: yes.

Long answer:

1.  When solution converges, estimates both packages show negligible differences.
2.  When solution diverges, GEE package stops with an error message. GEEPACK package produces errorneous estimates (some extreme values), no error messages shown.

### 2 - Estimate QELR parameters using GEE with different working correlations

Short answer: only independence correlation works. Tested on exchangeable, ar1, unstructured, these three correlation structures did not work.

## Simulation Setup

5 different simulations are setup as below:

| Name | p   | n   | iter | QELR Parameter |
|------|-----|-----|------|----------------|
| Sim1 | 3   | 300 | 500  | V1             |
| Sim2 | 3   | 300 | 500  | V2             |
| Sim3 | 5   | 300 | 500  | V3             |
| Sim4 | 10  | 300 | 500  | V4             |
| Sim5 | 12  | 300 | 500  | V5             |
|      |     |     |      |                |

```{r}
allout$sim4<- allout[[8]]
allout$
```
